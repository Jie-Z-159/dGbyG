{% extends 'base.html' %}

{% block content %}
    <h1>Reaction Prediction</h1>
    <form method="POST" id="testFrm">
        {{ form.hidden_tag() }}    
        <div>
            {{ form.equation.label }}<br>
            {{ form.equation(size=50, id="equation-input") }}
            {% for error in form.equation.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </div>
        
        <div>
            {{ form.identifier_type.label }}<br>
            {{ form.identifier_type() }}
        </div>
        
        <div>
            {{ form.reaction_condition.label }}<br>
            {% for subfield in form.reaction_condition %}
                <label>{{ subfield() }} {{ subfield.label.text }}</label><br>
            {% endfor %}
        </div>

        <div>
            <button type="button" id="btnSubmit">提交</button>
        </div>
    </form>

    <div id="result"></div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(() => {
            $('#btnSubmit').on('click',(event)=>{
                let form = $('#testFrm');

                $.ajax({
                    type:'post',
                    url:"{{url_for('calculate')}}",
                    data:form.serialize(),
                    dataType:'json',
                    success:function(data){
                        $('#result').text(data.dG_prime);
                    }
                });
                event.preventDefault();
            });
        });
    </script>
{% endblock %}
